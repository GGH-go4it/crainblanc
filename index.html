<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Jeu de Vocabulaire N√©erlandais</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
        }
        .question {
            margin: 20px 0;
            font-size: 24px;
        }
        .options button {
            margin: 10px;
            padding: 10px 20px;
            font-size: 18px;
        }
        #resultat {
            margin: 20px;
            font-size: 20px;
        }
        #scoreFinal {
            font-size: 24px;
            font-weight: bold;
            margin-top: 20px;
        }
        #hallOfFame {
            margin-top: 30px;
            list-style-type: none;
            padding: 0;
            font-size: 18px;
        }
    </style>
</head>
<body>

<h1>Apprends le N√©erlandais : Parties du corps</h1>

<!-- Zone de jeu -->
<div id="jeu">
    <div id="nomJoueur"></div>
    <div class="question" id="question"></div>
    <div class="options" id="options"></div>
    <div id="resultat"></div>
</div>

<!-- Score final -->
<div id="scoreFinal" style="display:none;"></div>

<!-- üÜï Boutons Rejouer & Classement -->
<div id="actionsFinales" style="display:none; margin-top: 20px;">
    <button onclick="rejouer()">üîÅ Rejouer</button>
    <button onclick="afficherHallOfFame()">üèÜ Voir le classement</button>
</div>

<!-- Hall of Fame -->
<h2>üèÜ Hall of Fame</h2>
<ul id="hallOfFame"></ul>

<!-- Script principal -->
<script>
const vocabulaire = [
    {fr: "t√™te", nl: "hoofd"},
    {fr: "main", nl: "hand"},
    {fr: "pied", nl: "voet"},
    {fr: "jambe", nl: "been"},
    {fr: "bras", nl: "arm"},
    {fr: "oeil", nl: "oog"},
    {fr: "nez", nl: "neus"},
    {fr: "bouche", nl: "mond"},
    {fr: "oreille", nl: "oor"},
    {fr: "ventre", nl: "buik"},
    {fr: "doigt", nl: "vinger"},
    {fr: "genou", nl: "knie"},
    {fr: "cheville", nl: "enkel"},
    {fr: "coude", nl: "elleboog"},
    {fr: "cou", nl: "nek"}
];

let questions = [];
let index = 0;
let score = 0;
let joueur = prompt("Entrez votre nom :");

function melanger(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

function nouvelleQuestion() {
    if (index >= 10) {
        document.getElementById("jeu").style.display = "none";
        document.getElementById("scoreFinal").style.display = "block";
        document.getElementById("scoreFinal").innerText = `Bravo ${joueur} ! Ton score final est : ${score} points.`;
        document.getElementById("actionsFinales").style.display = "block"; // üëà Affiche les boutons

        // Enregistrement dans Firebase
        db.collection("scores").add({
            nom: joueur,
            score: score,
            date: new Date()
        })
        .then(() => {
            console.log("Score ajout√© avec succ√®s !");
            afficherHallOfFame();
        })
        .catch((error) => {
            console.error("Erreur lors de l'enregistrement du score :", error);
        });

        return;
    }

    document.getElementById("nomJoueur").innerText = `Joueur : ${joueur}`;

    const current = questions[index];
    document.getElementById("question").innerText = `Quel est le mot n√©erlandais pour : "${current.fr}" ?`;

    let propositions = [current.nl];
    while (propositions.length < 3) {
        let random = vocabulaire[Math.floor(Math.random() * vocabulaire.length)].nl;
        if (!propositions.includes(random)) {
            propositions.push(random);
        }
    }

    propositions = melanger(propositions);

    const optionsDiv = document.getElementById("options");
    optionsDiv.innerHTML = "";
    propositions.forEach(option => {
        const btn = document.createElement("button");
        btn.innerText = option;
        btn.onclick = () => verifier(option, current.nl);
        optionsDiv.appendChild(btn);
    });
}

function verifier(choix, reponse) {
    const resultatDiv = document.getElementById("resultat");
    if (choix === reponse) {
        score += 10;
        resultatDiv.innerHTML = "üéâ Bravo ! Bonne r√©ponse ! üéâ";
    } else {
        score -= 5;
        resultatDiv.innerHTML = "üòî Mauvaise r√©ponse, essaye encore ! üòî";
    }
    index++;
    setTimeout(nouvelleQuestion, 1000);
}

function afficherHallOfFame() {
    db.collection("scores")
      .orderBy("score", "desc")
      .limit(10)
      .get()
      .then((querySnapshot) => {
          const ul = document.getElementById("hallOfFame");
          ul.innerHTML = "";
          querySnapshot.forEach((doc) => {
              const data = doc.data();
              const li = document.createElement("li");
              li.textContent = `${data.nom} : ${data.score} points`;
              ul.appendChild(li);
          });
      });
}

function rejouer() {
    index = 0;
    score = 0;
    questions = melanger([...vocabulaire]).slice(0, 10);
    document.getElementById("jeu").style.display = "block";
    document.getElementById("scoreFinal").style.display = "none";
    document.getElementById("actionsFinales").style.display = "none";
    document.getElementById("resultat").innerHTML = "";
    demarrerJeu();
}

function demarrerJeu() {
    questions = melanger([...vocabulaire]).slice(0, 10);
    nouvelleQuestion();
}

demarrerJeu();
</script>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyCByqXyY5qLjAIS0lEDzOBkVk05OV3ZdR8",
    authDomain: "jeu-vocabulaire-ndls.firebaseapp.com",
    projectId: "jeu-vocabulaire-ndls",
    storageBucket: "jeu-vocabulaire-ndls.appspot.com",
    messagingSenderId: "224131224059",
    appId: "1:224131224059:web:11ccbe706c044354a4fb5e"
  };

  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
</script>

</body>
</html>
